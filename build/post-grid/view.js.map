{"version":3,"file":"post-grid/view.js","mappings":";;;;AAAA,MAAMA,QAAQ,GAAGC,QAAQ,CAACC,eAAe,CAACC,IAAI;AAE9C,MAAMC,CAAC,GAAIJ,QAAQ,KAAK,IAAI,IAAIA,QAAQ,KAAK,IAAI,GAAI;EACjDK,KAAK,EAAE,aAAa;EACpBC,EAAE,EAAE,GAAG;EACPC,EAAE,EAAE;AACR,CAAC,GAAG;EACAF,KAAK,EAAE,OAAO;EACdC,EAAE,EAAE,IAAI;EACRC,EAAE,EAAE;AACR,CAAC;AAED,SAASC,mBAAmBA,CAAA,EAAG;EAC3B,MAAMC,cAAc,GAAGR,QAAQ,CAACS,gBAAgB,CAAC,mCAAmC,CAAC;EACrF,IAAID,cAAc,CAACE,MAAM,KAAK,CAAC,EAAE;;EAEjC;EACAF,cAAc,CAACG,OAAO,CAAEC,aAAa,IAAK;IACtC,MAAMC,QAAQ,GAAGD,aAAa,CAACE,aAAa,CAAC,qBAAqB,CAAC;IACnE,IAAI,CAACD,QAAQ,EAAE;IACf,MAAME,QAAQ,GAAGH,aAAa,CAACE,aAAa,CAAC,eAAe,CAAC;IAC7D,MAAME,iBAAiB,GAAGC,QAAQ,CAACJ,QAAQ,CAACK,OAAO,CAACF,iBAAiB,EAAE,EAAE,CAAC,IAAI,CAAC;IAC/E,MAAMG,YAAY,GAAGF,QAAQ,CAACJ,QAAQ,CAACK,OAAO,CAACC,YAAY,EAAE,EAAE,CAAC,IAAI,CAAC;IACrE,MAAMC,WAAW,GAAGH,QAAQ,CAACJ,QAAQ,CAACK,OAAO,CAACE,WAAW,EAAE,EAAE,CAAC,IAAI,CAAC;IACnE,MAAMC,WAAW,GAAGJ,QAAQ,CAACJ,QAAQ,CAACK,OAAO,CAACG,WAAW,EAAE,EAAE,CAAC,IAAI,CAAC;IACnE,MAAMC,OAAO,GAAGL,QAAQ,CAACJ,QAAQ,CAACK,OAAO,CAACI,OAAO,EAAE,EAAE,CAAC,IAAI,CAAC;IAC3D,MAAMC,IAAI,GAAGV,QAAQ,CAACK,OAAO,CAACK,IAAI,KAAK,MAAM;IAC7C,MAAMC,QAAQ,GAAGX,QAAQ,CAACK,OAAO,CAACM,QAAQ,KAAK,MAAM;IACrD,MAAMC,GAAG,GAAGZ,QAAQ,CAACK,OAAO,CAACO,GAAG,KAAK,MAAM;IAC3C,MAAMC,IAAI,GAAGb,QAAQ,CAACK,OAAO,CAACQ,IAAI,KAAK,MAAM;IAC7C;IACA,MAAMC,MAAM,GAAGC,GAAG,CAAC;MACfC,SAAS,EAAEhB,QAAQ;MACnBiB,KAAK,EAAEX,YAAY;MACnBG,OAAO,EAAEA,OAAO;MAChBE,QAAQ,EAAEA,QAAQ;MAClBO,iBAAiB,EAAEhB,QAAQ;MAC3BA,QAAQ,EAAE,IAAI;MACdU,GAAG,EAAEA,GAAG;MACRO,oBAAoB,EAAE,KAAK;MAC3BN,IAAI,EAAEA,IAAI;MACVO,MAAM,EAAE,EAAE;MACVC,oBAAoB,EAAE,IAAI;MAE1BC,UAAU,EAAE;QACR,IAAI,EAAE;UACFL,KAAK,EAAEd;QAEX,CAAC;QACD,IAAI,EAAE;UAAEc,KAAK,EAAEX;QAAa,CAAC;QAC7B,GAAG,EAAE;UACDW,KAAK,EAAEX,YAAY,GAAG,CAAC;UACvBiB,WAAW,EAAEb,IAAI,GAAG,CAAC,GAAG,CAAC;UAAE;UAC3Bc,SAAS,EAAE;QAEf,CAAC;QACD,GAAG,EAAE;UACDP,KAAK,EAAEV;QACX,CAAC;QACD,GAAG,EAAE;UACDU,KAAK,EAAET,WAAW;UAClBY,MAAM,EAAE,EAAE;UACVX,OAAO,EAAE;QACb,CAAC;QACD,CAAC,EAAE;UACCQ,KAAK,EAAET,WAAW;UAClBY,MAAM,EAAE,EAAE;UACVG,WAAW,EAAEb,IAAI,GAAG,EAAE,GAAG,CAAC;UAAE;UAC5Bc,SAAS,EAAE;QACf;MACJ;IAEJ,CAAC,CAAC;IACF,SAASC,yBAAyBA,CAAA,EAAG;MACjC,MAAMC,IAAI,GAAGZ,MAAM,CAACa,OAAO,CAAC,CAAC;MAC7B,MAAMC,MAAM,GAAG5B,QAAQ,CAACJ,gBAAgB,CAAC,WAAW,CAAC;MAErDgC,MAAM,CAAC9B,OAAO,CAAC,CAACP,KAAK,EAAEsC,KAAK,KAAK;QAC7B,MAAMC,SAAS,GAAGD,KAAK,IAAIH,IAAI,CAACG,KAAK,IAAIA,KAAK,GAAGH,IAAI,CAACG,KAAK,GAAGH,IAAI,CAACT,KAAK;QAExE1B,KAAK,CAACwC,YAAY,CAAC,aAAa,EAAED,SAAS,GAAG,OAAO,GAAG,MAAM,CAAC;QAE/DvC,KAAK,CAACK,gBAAgB,CAAC,gDAAgD,CAAC,CACnEE,OAAO,CAACkC,EAAE,IAAI;UACX,IAAIF,SAAS,EAAE;YACXE,EAAE,CAACC,eAAe,CAAC,UAAU,CAAC;UAClC,CAAC,MAAM;YACHD,EAAE,CAACD,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC;UACrC;QACJ,CAAC,CAAC;MACV,CAAC,CAAC;IACN;IACA,SAASG,gBAAgBA,CAACpB,MAAM,EAAEf,aAAa,EAAE;MAC7C,MAAMoC,UAAU,GAAGpC,aAAa,CAACE,aAAa,CAAC,iBAAiB,CAAC;MACjE,IAAI,CAACkC,UAAU,EAAE;MAEjB,MAAMT,IAAI,GAAGZ,MAAM,CAACa,OAAO,CAAC,CAAC;MAC7B,MAAMS,YAAY,GAAGV,IAAI,CAACW,YAAY,IAAIX,IAAI,CAACG,KAAK,GAAG,CAAC;MACxD,MAAMS,UAAU,GAAGF,YAAY,GAAGV,IAAI,CAACT,KAAK,GAAG,CAAC;MAChD,MAAMsB,WAAW,GAAGxC,aAAa,CAACH,gBAAgB,CAAC,kCAAkC,CAAC,CAACC,MAAM;MAC7F,IAAI2C,UAAU,GAAGF,UAAU,GAAGC,WAAW,GAAI,CAACD,UAAU,GAAG,CAAC,IAAIC,WAAW,GAAI,CAAC,GAAGD,UAAU;MAC7FH,UAAU,CAACM,WAAW,GAAG,GAAGnD,CAAC,CAACC,KAAK,IAAI6C,YAAY,IAAI9C,CAAC,CAACE,EAAE,IAAIgD,UAAU,IAAIlD,CAAC,CAACG,EAAE,IAAI8C,WAAW,EAAE;IACtG;IAEAd,yBAAyB,CAAC,CAAC;IAC3BS,gBAAgB,CAACpB,MAAM,EAAEf,aAAa,CAAC;IACvCe,MAAM,CAAC4B,MAAM,CAACC,EAAE,CAAC,cAAc,EAAE,MAAM;MACnClB,yBAAyB,CAAC,CAAC;MAC3BS,gBAAgB,CAACpB,MAAM,EAAEf,aAAa,CAAC;MACvC,MAAM2B,IAAI,GAAGZ,MAAM,CAACa,OAAO,CAAC,CAAC;MAC7B,MAAMiB,UAAU,GAAG7C,aAAa,CAACE,aAAa,CAAC,WAAW,CAAC;MAC3D,MAAM4C,UAAU,GAAG9C,aAAa,CAACE,aAAa,CAAC,WAAW,CAAC;MAC3D,IAAI,CAACY,IAAI,EAAE;QACP;QACA,IAAIa,IAAI,CAACG,KAAK,KAAK,CAAC,EAAE;UAClBe,UAAU,CAACE,QAAQ,GAAG,IAAI;UAC1BF,UAAU,CAACG,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;QACxC,CAAC,MAAM;UACHJ,UAAU,CAACE,QAAQ,GAAG,KAAK;UAC3BF,UAAU,CAACG,SAAS,CAACE,MAAM,CAAC,UAAU,CAAC;QAC3C;;QAEA;QACA,IAAIvB,IAAI,CAACG,KAAK,GAAGH,IAAI,CAACT,KAAK,IAAIS,IAAI,CAACwB,UAAU,EAAE;UAC5CL,UAAU,CAACC,QAAQ,GAAG,IAAI;UAC1BD,UAAU,CAACE,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;QACxC,CAAC,MAAM;UACHH,UAAU,CAACC,QAAQ,GAAG,KAAK;UAC3BD,UAAU,CAACE,SAAS,CAACE,MAAM,CAAC,UAAU,CAAC;QAC3C;MACJ;IACJ,CAAC,CAAC;;IAEF;IACA,IAAIE,UAAU,GAAG,KAAK;IACtB,IAAIC,WAAW,GAAG,IAAI;IAEtBpD,QAAQ,CAACqD,gBAAgB,CAAC,YAAY,EAAGC,CAAC,IAAK;MAC3CH,UAAU,GAAG,KAAK;MAClBC,WAAW,GAAGE,CAAC,CAACC,MAAM,CAACC,OAAO,CAAC,uBAAuB,CAAC;IAC3D,CAAC,CAAC;IAEFxD,QAAQ,CAACqD,gBAAgB,CAAC,WAAW,EAAE,MAAM;MACzCF,UAAU,GAAG,IAAI;IACrB,CAAC,CAAC;IAEFnD,QAAQ,CAACqD,gBAAgB,CAAC,UAAU,EAAE,MAAM;MACxC,IAAIF,UAAU,IAAIC,WAAW,EAAE;QAC3BA,WAAW,CAAC/C,OAAO,CAACoD,UAAU,GAAG,MAAM;QACvCC,UAAU,CAAC,MAAM;UACb,OAAON,WAAW,CAAC/C,OAAO,CAACoD,UAAU;QACzC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;MACb;IACJ,CAAC,CAAC;IAEFzD,QAAQ,CAACqD,gBAAgB,CACrB,OAAO,EACNC,CAAC,IAAK;MACH,MAAMC,MAAM,GAAGD,CAAC,CAACC,MAAM,CAACC,OAAO,CAAC,uBAAuB,CAAC;MACxD,IAAID,MAAM,EAAElD,OAAO,CAACoD,UAAU,KAAK,MAAM,EAAE;QACvCH,CAAC,CAACK,cAAc,CAAC,CAAC;QAClBL,CAAC,CAACM,wBAAwB,CAAC,CAAC;MAChC;IACJ,CAAC,EACD,IAAI,CAAC;IACT,CAAC;EAEL,CAAC,CAAC;AACN;;AAEA;AACAzE,QAAQ,CAACkE,gBAAgB,CAAC,kBAAkB,EAAE,MAAM;EAChD3D,mBAAmB,CAAC,CAAC;AACzB,CAAC,CAAC,C","sources":["webpack://dahlia-blocks/./src/post-grid/view.js"],"sourcesContent":["const htmlLang = document.documentElement.lang;\n\nconst t = (htmlLang === 'ca' || htmlLang === 'es') ? {\n    slide: 'Diapositiva',\n    to: 'a',\n    of: 'de'\n} : {\n    slide: 'Slide',\n    to: 'to',\n    of: 'of'\n};\n\nfunction initializeCarousels() {\n    const carouselBlocks = document.querySelectorAll('.wp-block-dahlia-blocks-post-grid');\n    if (carouselBlocks.length === 0) return;\n\n    // Recorremos todos los elementos de tipo carousel.\n    carouselBlocks.forEach((carouselBlock) => {\n        const carousel = carouselBlock.querySelector('.post-grid-carousel');\n        if (!carousel) return;\n        const controls = carouselBlock.querySelector('.tns-controls');\n        const itemsLargeDesktop = parseInt(carousel.dataset.itemsLargeDesktop, 10) || 4;\n        const itemsDesktop = parseInt(carousel.dataset.itemsDesktop, 10) || 4;\n        const itemsTablet = parseInt(carousel.dataset.itemsTablet, 10) || 2;\n        const itemsMobile = parseInt(carousel.dataset.itemsMobile, 10) || 1;\n        const slideBy = parseInt(carousel.dataset.slideBy, 10) || 1;\n        const peek = carousel.dataset.peek === 'true';\n        const autoplay = carousel.dataset.autoplay === 'true';\n        const nav = carousel.dataset.nav === 'true';\n        const loop = carousel.dataset.loop === 'true';\n        // Inicializamos Tiny Slider.\n        const slider = tns({\n            container: carousel,\n            items: itemsDesktop,\n            slideBy: slideBy,\n            autoplay: autoplay,\n            controlsContainer: controls,\n            controls: true,\n            nav: nav,\n            autoplayButtonOutput: false,\n            loop: loop,\n            gutter: 30,\n            preventScrollOnTouch: true,\n\n            responsive: {\n                1750: {\n                    items: itemsLargeDesktop,\n\n                },\n                1200: { items: itemsDesktop },\n                992: {\n                    items: itemsDesktop - 1,\n                    edgePadding: peek ? 0 : 0, // Show part of the next slide if \"peek\" is true\n                    mouseDrag: false,\n\n                },\n                768: {\n                    items: itemsTablet\n                },\n                576: {\n                    items: itemsMobile,\n                    gutter: 30,\n                    slideBy: 1,\n                },\n                0: {\n                    items: itemsMobile,\n                    gutter: 20,\n                    edgePadding: peek ? 75 : 0, // Show part of the next slide if \"peek\" is true\n                    mouseDrag: true\n                },\n            },\n\n        });\n        function updateSlidesAccessibility() {\n            const info = slider.getInfo();\n            const slides = carousel.querySelectorAll('.tns-item');\n\n            slides.forEach((slide, index) => {\n                const isVisible = index >= info.index && index < info.index + info.items;\n\n                slide.setAttribute('aria-hidden', isVisible ? 'false' : 'true');\n\n                slide.querySelectorAll('a, button, input, textarea, select, [tabindex]')\n                    .forEach(el => {\n                        if (isVisible) {\n                            el.removeAttribute('tabindex');\n                        } else {\n                            el.setAttribute('tabindex', '-1');\n                        }\n                    });\n            });\n        }\n        function updateLiveRegion(slider, carouselBlock) {\n            const liveRegion = carouselBlock.querySelector('.tns-liveregion');\n            if (!liveRegion) return;\n\n            const info = slider.getInfo();\n            const currentStart = info.displayIndex || info.index + 1;\n            const currentEnd = currentStart + info.items - 1;\n            const totalSlides = carouselBlock.querySelectorAll('.tns-item:not(.tns-slide-cloned)').length;\n            let finalSlide = currentEnd > totalSlides ? ((currentEnd - 1) % totalSlides) + 1 : currentEnd;\n            liveRegion.textContent = `${t.slide} ${currentStart} ${t.to} ${finalSlide} ${t.of} ${totalSlides}`;\n        }\n\n        updateSlidesAccessibility();\n        updateLiveRegion(slider, carouselBlock);\n        slider.events.on('indexChanged', () => {\n            updateSlidesAccessibility();\n            updateLiveRegion(slider, carouselBlock);\n            const info = slider.getInfo();\n            const prevButton = carouselBlock.querySelector('.tns-prev');\n            const nextButton = carouselBlock.querySelector('.tns-next');\n            if (!loop) {\n                // Desactiva el botón \"prev\" si estás en el primer slide\n                if (info.index === 0) {\n                    prevButton.disabled = true;\n                    prevButton.classList.add('disabled');\n                } else {\n                    prevButton.disabled = false;\n                    prevButton.classList.remove('disabled');\n                }\n\n                // Desactiva el botón \"next\" si estás en el último slide\n                if (info.index + info.items >= info.slideCount) {\n                    nextButton.disabled = true;\n                    nextButton.classList.add('disabled');\n                } else {\n                    nextButton.disabled = false;\n                    nextButton.classList.remove('disabled');\n                }\n            }\n        });\n\n        // Gestió refinada de swipe vs click damunt d'enllaços/botons\n        let isDragging = false;\n        let startTarget = null;\n\n        carousel.addEventListener('touchstart', (e) => {\n            isDragging = false;\n            startTarget = e.target.closest('a, button, [tabindex]');\n        });\n\n        carousel.addEventListener('touchmove', () => {\n            isDragging = true;\n        });\n\n        carousel.addEventListener('touchend', () => {\n            if (isDragging && startTarget) {\n                startTarget.dataset.blockClick = 'true';\n                setTimeout(() => {\n                    delete startTarget.dataset.blockClick;\n                }, 100); // temps mínim per evitar clic accidental\n            }\n        });\n\n        carousel.addEventListener(\n            'click',\n            (e) => {\n                const target = e.target.closest('a, button, [tabindex]');\n                if (target?.dataset.blockClick === 'true') {\n                    e.preventDefault();\n                    e.stopImmediatePropagation();\n                }\n            },\n            true // captura abans que arribi a l'element\n        );\n\n    });\n}\n\n// DOMContentLoaded ensures this runs after the DOM is ready\ndocument.addEventListener('DOMContentLoaded', () => {\n    initializeCarousels();\n});"],"names":["htmlLang","document","documentElement","lang","t","slide","to","of","initializeCarousels","carouselBlocks","querySelectorAll","length","forEach","carouselBlock","carousel","querySelector","controls","itemsLargeDesktop","parseInt","dataset","itemsDesktop","itemsTablet","itemsMobile","slideBy","peek","autoplay","nav","loop","slider","tns","container","items","controlsContainer","autoplayButtonOutput","gutter","preventScrollOnTouch","responsive","edgePadding","mouseDrag","updateSlidesAccessibility","info","getInfo","slides","index","isVisible","setAttribute","el","removeAttribute","updateLiveRegion","liveRegion","currentStart","displayIndex","currentEnd","totalSlides","finalSlide","textContent","events","on","prevButton","nextButton","disabled","classList","add","remove","slideCount","isDragging","startTarget","addEventListener","e","target","closest","blockClick","setTimeout","preventDefault","stopImmediatePropagation"],"sourceRoot":""}