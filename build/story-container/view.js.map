{"version":3,"file":"story-container/view.js","mappings":"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","sources":["webpack://dahlia-blocks/./src/story-container/view.js"],"sourcesContent":["/**\n * Use this file for JavaScript code that you want to run in the front-end\n * on posts/pages that contain this block.\n *\n * When this file is defined as the value of the `viewScript` property\n * in `block.json` it will be enqueued on the front end of the site.\n *\n * Example:\n *\n * ```js\n * {\n *   \"viewScript\": \"file:./view.js\"\n * }\n * ```\n *\n * If you're not making any changes to this file because your project doesn't need any\n * JavaScript running in the front-end, then you should delete this file and remove\n * the `viewScript` property from `block.json`.\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n */\n\n/**\n * This script enhances the \"story-container\" block by adding a floating toggle\n * with accessible reading controls: increase font size, decrease font size, toggle font style.\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n */\n\n/* eslint-disable no-console */\n\n\ndocument.addEventListener('DOMContentLoaded', () => {\n\tconst containers = document.querySelectorAll('.wp-block-dahlia-blocks-story-container');\n\n\tcontainers.forEach((container) => {\n\t\tconst srNotice = document.createElement('p');\n\t\tsrNotice.classList.add('sr-only');\n\t\tsrNotice.setAttribute('role', 'note');\n\t\tsrNotice.textContent = 'Al final del conte hi trobareu opcions per canviar la mida del text i el tipus de lletra per facilitar la lectura als infants. S\\'activen amb el botÃ³ \"Mostrar opcions de lectura\"';\n\n\t\t\n\t\tlet currentFontSizeIndex = 0;\n\t\t// Apply initial font size\n\t\tconst fontSizes = [20, 25, 30, 35];\n\t\tcontainer.classList.add(`font-size-${currentFontSizeIndex}`);\n\n\t\t// === Create floating control container ===\n\t\tconst floatingControls = document.createElement('div');\n\t\tfloatingControls.classList.add('story-floating-toggle');\n\n\t\t// === Create toggle button  ===\n\t\tconst toggleButton = document.createElement('button');\n\t\ttoggleButton.classList.add('toggle-controls')\n\t\tconst icon = window.createDahliaIcon({ name: 'settings-sliders', size: 'large' });\n\t\ttoggleButton.appendChild(icon);\n\n\t\t// === Create collapsible menu container ===\n\t\tconst menu = document.createElement('div');\n\t\tmenu.classList.add('story-floating-menu');\n\t\tmenu.id = 'story-floating-menu';\n\n\t\t\n\n\t\t// === Define individual buttons ===\n\t\tconst buttons = [\n\t\t\t{\n\t\t\t\ttext: '+',\n\t\t\t\ticonName: 'plus-small',\n\t\t\t\tclassName: 'increase-font',\n\t\t\t\tariaLabel: 'Augmenta la mida del text',\n\t\t\t\taction: () => {\n\t\t\t\t\tif (currentFontSizeIndex < fontSizes.length - 1) {\n\t\t\t\t\t\tcontainer.classList.remove(`font-size-${currentFontSizeIndex}`);\n\t\t\t\t\t\tcurrentFontSizeIndex++;\n\t\t\t\t\t\tcontainer.classList.add(`font-size-${currentFontSizeIndex}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: '-',\n\t\t\t\ticonName: 'minus-small',\n\t\t\t\tclassName: 'decrease-font',\n\t\t\t\tariaLabel: 'Redueix la mida del text',\n\t\t\t\taction: () => {\n\t\t\t\t\tif (currentFontSizeIndex > 0) {\n\t\t\t\t\t\tcontainer.classList.remove(`font-size-${currentFontSizeIndex}`);\n\t\t\t\t\t\tcurrentFontSizeIndex--;\n\t\t\t\t\t\tcontainer.classList.add(`font-size-${currentFontSizeIndex}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: 'a/A',\n\t\t\t\ticonName: 'letter-case',\n\t\t\t\tclassName: 'toggle-font',\n\t\t\t\tariaLabel: 'Canvia la tipografia',\n\t\t\t\taction: () => {\n\t\t\t\t\tcontainer.classList.toggle('story-block-font');\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tconst domButtons = [];\n\t\t// === Create button elements and bind actions ===\n\t\tbuttons.forEach(({ text, iconName, className, ariaLabel, action }) => {\n\t\t\tconst btn = document.createElement('button');\n\t\t\tbtn.classList.add(className, 'wp-block-button');\n\t\t\t// btn.textContent = text;\n\t\t\tbtn.setAttribute('aria-label', ariaLabel);\n\t\t\tlet buttonIcon = window.createDahliaIcon({ name: iconName, size: 'medium' });\n\t\t\tbtn.appendChild(buttonIcon);\n\t\t\t\n\t\t\tbtn.addEventListener('click', (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\taction(); // Execute the intended action\n\t\t\t});\n\t\t\tmenu.appendChild(btn);\n\t\t\tdomButtons.push(btn);\n\t\t});\n\t\tfunction closedMenu() {\n\t\t\ttoggleButton.setAttribute('aria-label', 'Mostra opcions de lectura');\n\t\t\ttoggleButton.setAttribute('aria-expanded', 'false');\n\t\t\ttoggleButton.setAttribute('aria-controls', 'story-floating-menu');\n\t\t\tmenu.setAttribute('aria-hidden', 'true');\n\t\t\tdomButtons.forEach((btn) => {\n\t\t\t\tbtn.setAttribute('tabindex', -1);\n\t\t\t});\n\t\t}\n\t\tclosedMenu()\n\t\t// === Define open/close menu functions ===\n\t\tfunction openMenu() {\n\t\t\tcontainer.classList.add('open');\n\t\t\tchangeDahliaIcon(icon, { name: 'cross-small', size: 'large' });\n\t\t\ttoggleButton.setAttribute('aria-label', 'Tanca opcions de lectura');\n\t\t\ttoggleButton.setAttribute('aria-expanded', 'true');\n\t\t\tmenu.setAttribute('aria-hidden', 'false');\n\t\t\tdomButtons.forEach((btn) => {\n\t\t\t\tbtn.setAttribute('tabindex', 0);\n\t\t\t});\n\t\t\t\n\t\t}\n\n\t\tfunction closeMenu() {\n\t\t\tchangeDahliaIcon(icon, { name: 'settings-sliders', size: 'large' });\n\t\t\tcontainer.classList.remove('open');\n\t\t\ttoggleButton.focus()\n\t\t\tclosedMenu();\n\t\t}\n\n\t\t// === Toggle button: open/close menu ===\n\t\ttoggleButton.addEventListener('click', (e) => {\n\t\t\te.stopPropagation(); // evita que tanqui immediatament\n\t\t\tif (container.classList.contains('open')) {\n\t\t\t\tcloseMenu();\n\t\t\t} else {\n\t\t\t\topenMenu();\n\t\t\t}\n\t\t});\n\t\t// === Close menu with ESC key ===\n\t\tdocument.addEventListener('keydown', (e) => {\n\t\t\tif (e.key === 'Escape') {\n\t\t\t\tcloseMenu();\n\t\t\t}\n\t\t});\n\t\t// === Close menu on click outside ===\n\t\tdocument.addEventListener('click', (e) => {\n\t\t\tif (\n\t\t\t\t!floatingControls.contains(e.target) &&\n\t\t\t\tcontainer.classList.contains('open')\n\t\t\t) {\n\t\t\t\tcloseMenu();\n\t\t\t}\n\t\t});\n\n\t\t// === Append elements into the container (top of block) ===\n\t\tfloatingControls.appendChild(toggleButton);\n\t\tfloatingControls.appendChild(menu);\n\t\tcontainer.append(floatingControls, container.firstChild);\n\t\tcontainer.insertBefore(srNotice, container.firstChild);\n\t});\n});\n\n/* eslint-enable no-console */\n"],"names":["document","addEventListener","containers","querySelectorAll","forEach","container","srNotice","createElement","classList","add","setAttribute","textContent","currentFontSizeIndex","fontSizes","floatingControls","toggleButton","icon","window","createDahliaIcon","name","size","appendChild","menu","id","buttons","text","iconName","className","ariaLabel","action","length","remove","toggle","domButtons","btn","buttonIcon","e","stopPropagation","push","closedMenu","openMenu","changeDahliaIcon","closeMenu","focus","contains","key","target","append","firstChild","insertBefore"],"sourceRoot":""}